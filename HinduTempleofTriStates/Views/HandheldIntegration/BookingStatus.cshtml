@model HinduTempleofTriStates.Models.BookingStatusModel

<h2>Booking Status</h2>
<div id="status">
    <!-- Display booking status message; handle nulls gracefully -->
    <p>Status: @(Model?.StatusMessage ?? "No status available")</p>
    <!-- Display last updated time in a readable format; handle nulls gracefully -->
    <p>Last Updated: @(Model?.LastUpdated != null ? Model.LastUpdated.ToString("g") : "Not updated yet")</p>
</div>

<!-- Include SignalR script for real-time updates -->
<script src="~/lib/signalr/dist/browser/signalr.js"></script>
<script>
    // Establish SignalR connection to the booking hub
    const connection = new signalR.HubConnectionBuilder()
        .withUrl("/bookingHub") // Ensure this URL matches your BookingHub setup
        .build();

    // Client-side listener for receiving booking updates from the server
    connection.on("ReceiveBookingUpdate", function (message) {
        // Update the status div with the received message
        document.getElementById("status").innerHTML = `<p>${message}</p>`;
    });

    // Start the SignalR connection
    connection.start().catch(function (err) {
        // Log any errors if the connection fails
        return console.error(err.toString());
    });
</script>
